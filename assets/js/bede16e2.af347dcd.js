"use strict";(self.webpackChunkdocs_oasis_dev=self.webpackChunkdocs_oasis_dev||[]).push([[7767],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=d(n),c=r,h=p["".concat(l,".").concat(c)]||p[c]||m[c]||o;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},1564:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(7294),r=n(6010),o=n(9960),i=n(3438),s=n(3919),l=n(5999);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};function u(e){let{href:t,children:n}=e;return a.createElement(o.Z,{href:t,className:(0,r.Z)("card padding--lg",d.cardContainer)},n)}function p(e){let{href:t,icon:n,title:o,description:i}=e;return a.createElement(u,{href:t},a.createElement("h2",{className:(0,r.Z)("text--truncate",d.cardTitle),title:o},n," ",o),i&&a.createElement("p",{className:(0,r.Z)("text--truncate",d.cardDescription),title:i},i))}function m(e){let{item:t}=e;const n=(0,i.Wl)(t);return n?a.createElement(p,{href:n,icon:"\ud83d\uddc3\ufe0f",title:t.label,description:(0,l.I)({message:"{count} items",id:"theme.docs.DocCard.categoryDescription",description:"The default description for a category card in the generated index about how many items this category includes"},{count:t.items.length})}):null}function c(e){let{item:t}=e;const n=(0,s.Z)(t.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",r=(0,i.xz)(t.docId??void 0);return a.createElement(p,{href:t.href,icon:n,title:t.label,description:r?.description})}function h(e){let{item:t}=e;switch(t.type){case"link":return a.createElement(c,{item:t});case"category":return a.createElement(m,{item:t});default:throw new Error(`unknown item type ${JSON.stringify(t)}`)}}},5162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(7294),r=n(6010);const o={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:n,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o.tabItem,i),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>v});var a=n(7462),r=n(7294),o=n(6010),i=n(2466),s=n(6550),l=n(1980),d=n(7392),u=n(12);function p(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function m(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,d.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function c(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,s.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=m(e),[i,s]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!c({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[l,d]=h({queryString:n,groupId:a}),[p,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),k=(()=>{const e=l??p;return c({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{k&&s(k)}),[k]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!c({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);s(e),d(e),f(e)}),[d,f,o]),tabValues:o}}var k=n(2389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){let{className:t,block:n,selectedValue:s,selectValue:l,tabValues:d}=e;const u=[],{blockElementScrollPositionUntilNextRender:p}=(0,i.o5)(),m=e=>{const t=e.currentTarget,n=u.indexOf(t),a=d[n].value;a!==s&&(p(t),l(a))},c=e=>{let t=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},d.map((e=>{let{value:t,label:n,attributes:i}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>u.push(e),onKeyDown:c,onClick:m},i,{className:(0,o.Z)("tabs__item",b.tabItem,i?.className,{"tabs__item--active":s===t})}),n??t)})))}function g(e){let{lazy:t,children:n,selectedValue:a}=e;if(n=Array.isArray(n)?n:[n],t){const e=n.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},n.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function N(e){const t=f(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",b.tabList)},r.createElement(y,(0,a.Z)({},e,t)),r.createElement(g,(0,a.Z)({},e,t)))}function v(e){const t=(0,k.Z)();return r.createElement(N,(0,a.Z)({key:String(t)},e))}},7525:(e,t,n)=>{n.d(t,{n:()=>o});var a=n(4477);function r(e){for(const t of e){const e=t.href;e&&void 0===globalThis.sidebarItemsMap[e]&&(globalThis.sidebarItemsMap[e]=t),"category"===t.type&&r(t.items)}}function o(e){const t=(0,a.E)();if(!t)throw new Error("Unexpected: cant find docsVersion in current context");if(void 0===globalThis.sidebarItemsMap){globalThis.sidebarItemsMap={};for(const e in t.docsSidebars)r(t.docsSidebars[e])}if(void 0===globalThis.sidebarItemsMap[e])throw console.log("Registered sidebar items:"),console.log(globalThis.sidebarItemsMap),new Error("Unexpected: sidebar item with href "+e+" does not exist.");return globalThis.sidebarItemsMap[e]}},2129:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>u,default:()=>k,frontMatter:()=>d,metadata:()=>p,toc:()=>c});var a=n(7462),r=(n(7294),n(3905)),o=n(1564),i=n(7525),s=n(4866),l=n(5162);const d={},u="ParaTime Node",p={unversionedId:"node/run-your-node/paratime-node",id:"node/run-your-node/paratime-node",title:"ParaTime Node",description:"These instructions are for setting up a ParaTime node which participates in one or more ParaTime compute committees. If you want to run a ParaTime client node instead, see the instructions for running a ParaTime client node. If you want to run a validator node instead, see the instructions for running a validator node. Similarly, if you want to run a non-validator node instead, see the instructions for running a non-validator node.",source:"@site/docs/node/run-your-node/paratime-node.mdx",sourceDirName:"node/run-your-node",slug:"/node/run-your-node/paratime-node",permalink:"/node/run-your-node/paratime-node",draft:!1,editUrl:"https://github.com/oasisprotocol/docs/edit/main/docs/node/run-your-node/paratime-node.mdx",tags:[],version:"current",lastUpdatedAt:1678701669,formattedLastUpdatedAt:"Mar 13, 2023",frontMatter:{},sidebar:"operators",previous:{title:"Archive Node",permalink:"/node/run-your-node/archive-node"},next:{title:"ParaTime Client Node",permalink:"/node/run-your-node/paratime-client-node"}},m={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Stake Requirements",id:"stake-requirements",level:3},{value:"Register a New Entity or Update Your Entity Registration",id:"register-a-new-entity-or-update-your-entity-registration",level:3},{value:"The ParaTime Bundle",id:"the-paratime-bundle",level:3},{value:"Install Oasis Core Runtime Loader",id:"install-oasis-core-runtime-loader",level:3},{value:"Install ParaTime Bundle",id:"install-paratime-bundle",level:3},{value:"Install Bubblewrap Sandbox (at least version 0.3.3)",id:"install-bubblewrap-sandbox-at-least-version-033",level:3},{value:"Setting up Trusted Execution Environment (TEE)",id:"setting-up-trusted-execution-environment-tee",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Starting the Oasis Node",id:"starting-the-oasis-node",level:2},{value:"Checking Node Status",id:"checking-node-status",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Too Old Bubblewrap Version",id:"too-old-bubblewrap-version",level:3},{value:"Bubblewrap Sandbox Fails to Start",id:"bubblewrap-sandbox-fails-to-start",level:3},{value:"Stake Requirement",id:"stake-requirement",level:3},{value:"See also",id:"see-also",level:2}],h={toc:c},f="wrapper";function k(e){let{components:t,...n}=e;return(0,r.kt)(f,(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"paratime-node"},"ParaTime Node"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"These instructions are for setting up a ",(0,r.kt)("em",{parentName:"p"},"ParaTime")," node which participates in one or more ParaTime compute committees. If you want to run a ",(0,r.kt)("em",{parentName:"p"},"ParaTime client")," node instead, see the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/paratime-client-node"},"instructions for running a ParaTime client node"),". If you want to run a ",(0,r.kt)("em",{parentName:"p"},"validator")," node instead, see the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/validator-node/"},"instructions for running a validator node"),". Similarly, if you want to run a non-validator node instead, see the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/non-validator-node"},"instructions for running a non-validator node"),".")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"For a production setup, we recommend running the ParaTime compute/storage node separately from the validator node (if you run one)."),(0,r.kt)("p",{parentName:"admonition"},"Running ParaTime and validator nodes as separate Oasis nodes will prevent configuration mistakes and/or (security) issues affecting one node type from affecting the other one.")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If you are looking for some concrete ParaTimes that you can run, see ",(0,r.kt)("a",{parentName:"p",href:"/get-involved/run-node/paratime-node"},"the list of ParaTimes and their parameters"),".")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Oasis Core refers to ParaTimes as runtimes internally, so all configuration options will have runtime in their name.")),(0,r.kt)("p",null,"This guide will cover setting up your ParaTime compute node for the Oasis Network. This guide assumes some basic knowledge on the use of command line tools."),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"Before following this guide, make sure you've followed the ",(0,r.kt)("a",{parentName:"p",href:"prerequisites"},"Prerequisites")," and ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/non-validator-node"},"Run a Non-validator Node")," sections and have:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Oasis Node binary installed and configured on your system."),(0,r.kt)("li",{parentName:"ul"},"The chosen top-level ",(0,r.kt)("inlineCode",{parentName:"li"},"/node/")," working directory prepared. In addition to ",(0,r.kt)("inlineCode",{parentName:"li"},"etc")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"data")," directories, also prepare the following directories:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"bin"),": This will store binaries needed by Oasis Node for running the ParaTimes."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"runtimes"),": This will store the ParaTime bundles.")))),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Feel free to name your working directory as you wish, e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"/srv/oasis/"),"."),(0,r.kt)("p",{parentName:"admonition"},"Just make sure to use the correct working directory path in the instructions below.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Genesis file copied to ",(0,r.kt)("inlineCode",{parentName:"li"},"/node/etc/genesis.json"),".")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Reading the rest of the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/validator-node/"},"validator node setup instructions")," may also be useful.")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"To speed up bootstraping your new node, we recommend ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/advanced/copy-state-from-one-node-to-the-other"},"copying node's state from your existing node")," or ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/advanced/sync-node-using-state-sync"},"syncing it using state sync"),".")),(0,r.kt)("h3",{id:"stake-requirements"},"Stake Requirements"),(0,r.kt)("p",null,"To be able to register as a ParaTime node on the Oasis Network, you need to\nhave enough tokens staked in your entity's escrow account."),(0,r.kt)("p",null,"Current minimum staking requirements for a specific ParaTime are listed on the\nContribute to the Network section - ",(0,r.kt)("a",{parentName:"p",href:"/get-involved/run-node/paratime-node"},"Run a ParaTime Node")," page. Should you want\nto check the staking requirements for other node roles and registered ParaTimes\nmanually, use the Oasis CLI tools as described in ",(0,r.kt)("a",{parentName:"p",href:"/general/manage-tokens/advanced/oasis-cli-tools/common-staking-info"},"Common Staking Info"),"."),(0,r.kt)("p",null,"Finally, to stake the tokens, use our ",(0,r.kt)("a",{parentName:"p",href:"/general/manage-tokens/advanced/oasis-cli-tools/delegate-tokens"},"Oasis CLI tools"),". If everything was set\nup correctly, you should see something like below when running ",(0,r.kt)("a",{parentName:"p",href:"/general/manage-tokens/advanced/oasis-cli-tools/get-account-info"},"Oasis Node\nStake Account Info")," command for your entity's account (this is an example for\nthe Testnet):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"Balance:\n  Total: 0.0 TEST\n  Available: 0.0 TEST\n\nActive Delegations to this Account:\n  Total: 20000.0 TEST (20000000000000 shares)\n  Delegations:\n    - From:   oasis1qrwdwxutpyr9d2m84zh55rzcf99aw0hkts7myvv9\n      Amount: 20000.0 TEST (20000000000000 shares)\n\nStake Accumulator:\n  Claims:\n    - Name: registry.RegisterEntity\n      Staking Thresholds:\n        - Global: entity\n    - Name: registry.RegisterNode.HG5TB3dbY8gtYBBw/R/cHfPaOpe0vT7W1wu/2rtpk/A=\n      Staking Thresholds:\n        - Global: node-compute\n      Staking Thresholds:\n        - Global: node-storage\n\nNonce: 1\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"The stake requirements may differ from ParaTime to ParaTime and are subject to\nchange in the future.")),(0,r.kt)("h3",{id:"register-a-new-entity-or-update-your-entity-registration"},"Register a New Entity or Update Your Entity Registration"),(0,r.kt)("p",null,"If you don't have an entity yet, create a new one by following the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/validator-node/#creating-your-entity"},"Creating Your Entity")," instructions."),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"Everything in this section should be done on the ",(0,r.kt)("inlineCode",{parentName:"p"},"localhost")," as there are sensitive items that will be created.")),(0,r.kt)("p",null,"If you will be running the ParaTime on a new Oasis Node, initialize a new node by following the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/validator-node/#initializing-a-node"},"Initializing a Node")," instructions."),(0,r.kt)("p",null,"Then update your entity descriptor by enumerating paths to all your node's descriptors (existing and new ones) in the ",(0,r.kt)("inlineCode",{parentName:"p"},"--entity.node.descriptor")," flag. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"oasis-node registry entity update \\\n    ... various signer flags ... \\\n    --entity.node.descriptor /localhost/node1/node_genesis.json,/localhost/node2/node_genesis.json\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"To confirm all nodes are added to your entity descriptor, run:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cat <PATH-TO-entity.json>\n")),(0,r.kt)("p",{parentName:"admonition"},"and ensure you see all your nodes' IDs under the ",(0,r.kt)("inlineCode",{parentName:"p"},'"nodes"')," list."),(0,r.kt)("p",{parentName:"admonition"},"For example:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{\n  "v": 2,\n  "id": "QTg+ZjubD/36egwByAIGC6lMVBKgqo7xnZPgHVoIKzc=",\n  "nodes": [\n    "yT1h8/eN0VInQxn3YKcHxvSgGcsjsTSYmdTLZZMBTWI=",\n    "HG5TB3dbY8gtYBBw/R/cHfPaOpe0vT7W1wu/2rtpk/A="\n  ]\n}\n'))),(0,r.kt)("p",null,"Then generate and submit the new/updated entity descriptor via the entity registration transaction by following the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/validator-node/#generating-entity-registration-transaction"},"Generating Entity Registration Transaction")," instructions."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Make sure your entity descriptor (i.e. ",(0,r.kt)("inlineCode",{parentName:"p"},"entity.json"),") is copied to your online server and saved as ",(0,r.kt)("inlineCode",{parentName:"p"},"/node/entity/entity.json")," to ensure the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/paratime-node#configuration"},"node's configuration")," will find it.")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"You will ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/paratime-node#configuration"},"configure the node")," to automatically register for the roles it has enabled (i.e. storage and compute roles) via the ",(0,r.kt)("inlineCode",{parentName:"p"},"worker.registration.entity")," configuration flag."),(0,r.kt)("p",{parentName:"admonition"},"No manual node registration is necessary.")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"ParaTime rewards for running the compute node will be sent to your entity address ",(0,r.kt)("strong",{parentName:"p"},"inside the ParaTime"),". To access the rewards on the consensus layer, you will need to withdraw them first. Read the ",(0,r.kt)("a",{parentName:"p",href:"/general/manage-tokens/advanced/oasis-cli-tools/deposit-withdraw-tokens-to-from-paratime"},"Deposit/Withdraw Tokens to/from ParaTime")," chapter to learn more.")),(0,r.kt)("h3",{id:"the-paratime-bundle"},"The ParaTime Bundle"),(0,r.kt)("p",null,"In order to run a ParaTime node you need to obtain the ParaTime bundle that\nneeds to come from a trusted source. The bundle (usually with an ",(0,r.kt)("inlineCode",{parentName:"p"},".orc"),"\nextension that stands for Oasis Runtime Container) contains all the needed\nParaTime binaries together with the identifier and version metadata to ease\ndeployment."),(0,r.kt)("p",null,"When the ParaTime is running in a Trusted Execution Environment (TEE) the bundle\nwill also contain all the required artifacts (e.g. SGXS version of the binary\nand any enclave signatures)."),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"Like the genesis document, make sure you obtain these from a trusted source.")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("h4",{parentName:"admonition",id:"compiling-the-paratime-binary-from-source-code"},(0,r.kt)("strong",{parentName:"h4"},"Compiling the ParaTime Binary from Source Code")),(0,r.kt)("p",{parentName:"admonition"},"In case you decide to build the ParaTime binary from source yourself, make sure\nthat you follow our ",(0,r.kt)("a",{parentName:"p",href:"/paratime/reproducibility"},"guidelines for deterministic compilation"),"\nto ensure that you receive the exact same binary."),(0,r.kt)("p",{parentName:"admonition"},"When the ParaTime is running in a TEE, a different binary to what is registered\nin the consensus layer will not work and will be rejected by the network.")),(0,r.kt)("h3",{id:"install-oasis-core-runtime-loader"},"Install Oasis Core Runtime Loader"),(0,r.kt)("p",null,"For ParaTimes running inside ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/paratime-node#setting-up-trusted-execution-environment-tee"},"Intel SGX Trusted Execution Environment"),", you will need to install the Oasis Core Runtime Loader."),(0,r.kt)("p",null,"The Oasis Core Runtime Loader binary (",(0,r.kt)("inlineCode",{parentName:"p"},"oasis-core-runtime-loader"),") is part of Oasis Core binary releases, so make sure you download the appropriate version specified the ",(0,r.kt)("a",{parentName:"p",href:"/node/mainnet/"},"Network Parameters")," page."),(0,r.kt)("p",null,"Install it to ",(0,r.kt)("inlineCode",{parentName:"p"},"bin")," subdirectory of your node's working directory, e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"/node/bin/oasis-core-runtime-loader"),"."),(0,r.kt)("h3",{id:"install-paratime-bundle"},"Install ParaTime Bundle"),(0,r.kt)("p",null,"For each ParaTime, you need to obtain its bundle and install it to the\n",(0,r.kt)("inlineCode",{parentName:"p"},"runtimes")," subdirectory of your node's working directory."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"For example, for the ",(0,r.kt)("a",{parentName:"p",href:"/node/mainnet/#cipher-paratime"},"Cipher ParaTime"),",\nyou would have to obtain the ",(0,r.kt)("inlineCode",{parentName:"p"},"cipher-paratime.orc")," bundle and install it to\n",(0,r.kt)("inlineCode",{parentName:"p"},"/node/runtimes/cipher-paratime.orc"),".")),(0,r.kt)("h3",{id:"install-bubblewrap-sandbox-at-least-version-033"},"Install Bubblewrap Sandbox (at least version 0.3.3)"),(0,r.kt)("p",null,"ParaTime compute nodes execute ParaTime binaries inside a sandboxed environment provided by ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/containers/bubblewrap"},"Bubblewrap"),". In order to install it, please follow these instructions, depending on your distribution:"),(0,r.kt)(s.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"Ubuntu 18.10+",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt install bubblewrap\n"))),(0,r.kt)(l.Z,{value:"Fedora",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo dnf install bubblewrap\n"))),(0,r.kt)(l.Z,{value:"Other Distributions",mdxType:"TabItem"},"On other systems, you can download the latest [source release provided by the Bubblewrap project](https://github.com/containers/bubblewrap/releases) and build it yourself.",(0,r.kt)("p",null,"Make sure you have the necessary development tools installed on your system and the ",(0,r.kt)("inlineCode",{parentName:"p"},"libcap")," development headers. On Ubuntu, you can install them with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt install build-essential libcap-dev\n")),(0,r.kt)("p",null,"After obtaining the Bubblewrap source tarball, e.g. ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/containers/bubblewrap/releases/download/v0.4.1/bubblewrap-0.4.1.tar.xz"},"bubblewrap-0.4.1.tar.xz"),", run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"tar -xf bubblewrap-0.4.1.tar.xz\ncd bubblewrap-0.4.1\n./configure --prefix=/usr\nmake\nsudo make install\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Note that Oasis Node expects Bubblewrap to be installed under ",(0,r.kt)("inlineCode",{parentName:"p"},"/usr/bin/bwrap")," by default.")))),(0,r.kt)("p",null,"Ensure you have a new enough version by running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"bwrap --version\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Ubuntu 18.04 LTS (and earlier) provide overly-old ",(0,r.kt)("inlineCode",{parentName:"p"},"bubblewrap"),". Follow ",(0,r.kt)("em",{parentName:"p"},"Other Distributions")," section on those systems.")),(0,r.kt)("h3",{id:"setting-up-trusted-execution-environment-tee"},"Setting up Trusted Execution Environment (TEE)"),(0,r.kt)("p",null,"If a ParaTime requires the use of a TEE, then make sure you set up TEE as instructed in the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee"},"Set up Trusted Execution Environment (TEE)")," doc."),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"In order to configure the node create the ",(0,r.kt)("inlineCode",{parentName:"p"},"/node/etc/config.yml")," file with the following content:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'datadir: /node/data\n\nlog:\n  level:\n    default: info\n    tendermint: info\n    tendermint/context: error\n  format: JSON\n\ngenesis:\n  file: /node/etc/genesis.json\n\nconsensus:\n  tendermint:\n    core:\n      listen_address: tcp://0.0.0.0:26656\n\n      # The external IP that is used when registering this node to the network.\n      # NOTE: If you are using the Sentry node setup, this option should be\n      # omitted.\n      external_address: tcp://{{ external_address }}:26656\n\n    p2p:\n      # List of seed nodes to connect to.\n      # NOTE: You can add additional seed nodes to this list if you want.\n      seed:\n        - "{{ seed_node_address }}"\n\nruntime:\n  mode: compute\n  paths:\n    # Paths to ParaTime bundles for all of the supported ParaTimes.\n    - "{{ runtime_orc_path }}"\n\n  # The following section is required for ParaTimes which are running inside the\n  # Intel SGX Trusted Execution Environment.\n  sgx:\n    loader: /node/bin/oasis-core-runtime-loader\n\nworker:\n  registration:\n    # In order for the node to register itself, the entity.json of the entity\n    # used to provision the node must be available on the node.\n    entity: /node/entity/entity.json\n\n  p2p:\n    # External P2P configuration.\n    port: 30002\n    addresses:\n      # The external IP that is used when registering this node to the network.\n      - "{{ external_address }}:30002"\n\n# The following section is required for ParaTimes which are running inside the\n# Intel SGX Trusted Execution Environment.\nias:\n  proxy:\n    address:\n      # List of IAS proxies to connect to.\n      # NOTE: You can add additional IAS proxies to this list if you want.\n      - "{{ ias_proxy_address }}"\n')),(0,r.kt)("p",null,"Before using this configuration you should collect the following information to replace the  variables present in the configuration file:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{{ external_address }}"),": The external IP you used when registering this node."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{{ seed_node_address }}"),": The seed node address in the form ",(0,r.kt)("inlineCode",{parentName:"li"},"ID@IP:port"),".",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"You can find the current Oasis Seed Node address in the ",(0,r.kt)("a",{parentName:"li",href:"/node/mainnet/"},"Network Parameters"),"."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{{ runtime_orc_path }}"),": Path to the ",(0,r.kt)("a",{parentName:"li",href:"/node/run-your-node/paratime-node#the-paratime-bundle"},"ParaTime bundle")," of the form ",(0,r.kt)("inlineCode",{parentName:"li"},"/node/runtimes/foo-paratime.orc"),".",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"You can find the current Oasis-supported ParaTimes in the ",(0,r.kt)("a",{parentName:"li",href:"/node/mainnet/#paratimes"},"Network Paramers"),"."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{{ ias_proxy_address }}"),": The IAS proxy address in the form ",(0,r.kt)("inlineCode",{parentName:"li"},"ID@HOST:port"),".",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"You can find the current Oasis IAS proxy address in the ",(0,r.kt)("a",{parentName:"li",href:"/node/mainnet/#cipher-paratime"},"Network Parameters"),"."),(0,r.kt)("li",{parentName:"ul"},"If you want, you can also ",(0,r.kt)("a",{parentName:"li",href:"/node/run-your-node/ias-proxy"},"run your own IAS proxy"),".")))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Make sure the ",(0,r.kt)("inlineCode",{parentName:"p"},"worker.p2p.port")," (default: ",(0,r.kt)("inlineCode",{parentName:"p"},"9200"),") port is exposed and publicly\naccessible on the internet (for ",(0,r.kt)("inlineCode",{parentName:"p"},"TCP")," traffic).")),(0,r.kt)("h2",{id:"starting-the-oasis-node"},"Starting the Oasis Node"),(0,r.kt)("p",null,"You can start the node by running the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"oasis-node --config /node/etc/config.yml\n")),(0,r.kt)("h2",{id:"checking-node-status"},"Checking Node Status"),(0,r.kt)("p",null,"To ensure that your node is properly connected with the network, you can run the following command after the node has started:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"oasis-node control status -a unix:/node/data/internal.sock\n")),(0,r.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("p",null,"See the general ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/troubleshooting"},"Node troubleshooting")," and ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee#troubleshooting"},"Set up TEE troubleshooting")," sections before proceeding with ParaTime node-specific troubleshooting."),(0,r.kt)("h3",{id:"too-old-bubblewrap-version"},"Too Old Bubblewrap Version"),(0,r.kt)("p",null,"Double check your installed ",(0,r.kt)("inlineCode",{parentName:"p"},"bubblewrap")," version, and ensure is at least of version ",(0,r.kt)("strong",{parentName:"p"},"0.3.3"),". For details see the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/paratime-node#install-bubblewrap-sandbox-at-least-version-0-3-3"},"Install Bubblewrap Sandbox")," section."),(0,r.kt)("h3",{id:"bubblewrap-sandbox-fails-to-start"},"Bubblewrap Sandbox Fails to Start"),(0,r.kt)("p",null,"If the environment in which you are running the ParaTime node applies too restricted Seccomp or AppArmor profiles, the Bubblewrap sandbox that isolates each runtime may fail to start. In the logs you will see how the runtime attempts to restart, but fails with an ",(0,r.kt)("inlineCode",{parentName:"p"},"bwrap")," error, like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{"level":"warn","module":"runtime","msg":"bwrap: Failed to mount tmpfs: Permission denied","runtime_id":"000000000000000000000000000000000000000000000000f80306c9858e7279","runtime_name":"sapphire-paratime","ts":"2023-03-06T10:08:51.983330021Z"}\n')),(0,r.kt)("p",null,"In case of ",(0,r.kt)("inlineCode",{parentName:"p"},"bwrap")," issues you need to adjust your Seccomp or AppArmor profiles to support Bubblewrap sandboxes. In Docker you can set or disable Seccomp and AppArmor profiles with parameters:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  --security-opt apparmor=unconfined \\\n  --security-opt seccomp=unconfined \\\n")),(0,r.kt)("h3",{id:"stake-requirement"},"Stake Requirement"),(0,r.kt)("p",null,"Double check your node entity satisfies the staking requirements for a ParaTime node. For details see the ",(0,r.kt)("a",{parentName:"p",href:"/node/run-your-node/paratime-node#stake-requirements"},"Stake Requirements")," section."),(0,r.kt)("h2",{id:"see-also"},"See also"),(0,r.kt)(o.Z,{item:(0,i.n)("/node/web3"),mdxType:"DocCard"}))}k.isMDXComponent=!0}}]);